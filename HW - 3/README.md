### Урок 6. Семинар. Создание проекта машинного обучения
Подумайте о реальной проблеме, которую, по вашему мнению, можно решить с помощью машинного обучения.
 Четко определите эту проблему и поставьте SMART-цели для ее решения. Помните, что это должна быть проблема, в которой машинное обучение может помочь сделать прогноз, классифицировать данные или дать рекомендации.

Определите потенциальные источники данных, которые могут быть использованы для решения вашей проблемы. Какие данные вам понадобятся? Где вы можете их получить? Напишите краткое резюме вашей стратегии сбора данных.

Даже если у вас нет реальных данных для анализа, представьте, что они у вас есть. Как бы вы стали исследовать и понимать эти данные? Что бы вы искали? Напишите краткое описание вашей стратегии анализа исследовательских данных.

Вспомните различные модели машинного обучения, которые мы обсуждали, в частности модель "Дерево решений". Какой тип модели машинного обучения будет наиболее подходящим для вашей проблемы и почему? Объясните свой выбор.

Напишите краткое описание того, как вы будете обучать и оценивать выбранную вами модель машинного обучения, используя воображаемый набор данных.

Наконец, подумайте о том, как вы могли бы развернуть свою обученную модель. Где она будет использоваться? Кто будет ее использовать? Какую пользу она принесет им? Напишите краткое резюме вашей стратегии развертывания.

Помните, что целью этого задания является не создание реальной модели машинного обучения (пока!), а применение концепций, которые вы изучили на этом семинаре, к реальной проблеме.

### Введение. Выбранная тема для рассмотрения.

Единого определения для machine learning (машинного обучения) пока нет. Большинство исследователей определяют этот термин так:

Машинное обучение — это наука о том, как заставить ИИ учиться и действовать как человек, а также сделать так, чтобы он сам постоянно улучшал свое обучение и способности на основе предоставленных нами данных о реальном мире.<br>
Целью машинного обучения является частичная или полная автоматизация человеческой деятельности в самых разных областях.<br>
Рассмотрим применение машинного обучения в такой области как биржевой технический анализ. <br>
Биржевой технический анализ – прогнозирование вероятного изменения цен на основе закономерностей изменений цен в прошлом в аналогичных обстоятельствах. <br> Вместе с биржевым анализом  рассматривается и прогнозирование временных рядов, так как данные рассматриваются на разыных временных промежутках.<br>
Прогнозирование временных рядов – предсказание будущих значений временного ряда по настоящим и прошлым значениям.

#### Немного об инвсетициях. Лирическое отступление. 

До перехода к рассмотренномму биржевому анализизу стоит рассмотреть тему инвестиций.

#### Инвестиции. Что они для нас значат и почему так важны?

Все мы в своей жизни являемся инвесторами, хотим мы того или нет!<br>
Мы инвестируем всегда своё время, внимание, свою энергию.<br>
Мы можем инвестировать в своё здоровье, обучение, в приобретение недвижимости, акции, золото и не только.<br>
Сама тема инвестиций, прогнозирования очень важна для каждого человека, куда и во что вкладывать свои внимание, энергию, время, деньги оказывается совсем не просто.<br>
Провести правильный анализ и сделать выбор с учетом многих имеющихся факторов, которые есть в нашей жизни становится всё сложнее.<br>
На многие простые вопросы, на первый взгляд, нет однозначных ответов, всё зависит от индивидуальных целей, ситуации и предпочтений.<br> 

К примеру:

1. Недвижимость или бизнес: Выбор между покупкой недвижимости и открытием бизнеса зависит от вашего опыта, рыночных условий и личных интересов. <br> Недвижимость может обеспечить стабильный доход и рост капитала, в то время как бизнес может предложить больший потенциал дохода при большем риске.
2. Отдых: Время и место для отдыха следует выбирать, исходя из личных предпочтений, бюджета и текущих обстоятельств.
3.	Инвестиции: Выбор между недвижимостью, золотом, акциями или криптовалютой требует глубокого анализа рынков и рисков,<br> понимания и определения вашего инвестиционного горизонта.<br> Например, недвижимость может быть более стабильной, но менее ликвидной, в то время как акции могут предложить высокую доходность при высоких рисках, собрать портфель инвестора может оказаться не просто.

<image src="img/2.jpg" alt="wind">


Важность инвестиций заключается в следующем:

1. Долгосрочное накопление: Инвестиции могут обеспечить финансовую безопасность на будущее.<br> Например, пенсионные накопления или инвестиции в образование детей.
2. Защита от инфляции: Инвестиции в активы, такие как недвижимость или акции, могут защитить сбережения от обесценивания из-за инфляции (деньги могут обесцениватьмся очень быстро, так как экономической стабильности не существует ни в одной стране мира).
3. Пассивный доход: Инвестиции могут генерировать дополнительный доход в виде дивидендов, процентов или арендной платы.
4. Доступ к капиталу: Инвестирование в собственный бизнес может открыть доступ к большему капиталу и возможностям для роста.
5. Диверсификация рисков: Разнообразие инвестиционного портфеля помогает снизить риски и стабилизировать доходы.

<image src="img/1.jpeg" alt="wind">

Инвестиции играют ключевую роль в экономическом росте и личном благосостоянии.<br> Они позволяют нам не только сохранять, но и приумножать наши ресурсы. 

ИИ может помочь в анализе данных, прогнозировании трендов и предоставлении информации для принятия обоснованных решений.<br> Однако, важно помнить, что ИИ является лишь инструментом, и окончательное решение всегда остается за человеком. <br> ИИ может предоставить различные сценарии и вероятности, но учесть все человеческие факторы и индивидуальные обстоятельства может только сам инвестор.<br>
Читая книгу «Ловушки мышления. Как принимать решения о которых вы не пожалеете» приходишь к выводу, что каждому человеку,<br> если он хочет получить результат в своей практической деятельности в разных сферах нужен независимый эксперт (консультант), который может показать интересующую тему с разных сторон и с учетом многих факторов,<br> которые мы практически не можем учесть (исходя из личного опыта и не только в сфере инвестирования).<br>
Тема «Инвестиции и прогнозирование» является очень актуальной для каждого человека, в которой ИИ может помогать каждому человеку делать свой ОСОЗНАННЫЙ ВЫБОР!!! Расмотрим применение ИИ для биржевого технического анализа.

# Биржевой технический анализ

<image src="img/3.jpeg" alt="wind">

### Этапы обучения, SMART-цели и проблемы.

Применение машинного обучения для биржевого технического анализа — это отличный пример реальной проблемы, которую можно решить с помощью данного подхода. Вот как я бы определил эту проблему и поставил бы SMART-цели:

Проблема:
Прогнозирование вероятных изменений цен на финансовых рынках на основе исторических данных о ценах и торговых объемах.

Создание модели машинного обучения для биржевого технического анализа включает в себя следующие ключевые этапы:

1. Определение проблемы и целей:<br>
•  Четкое определение задачи прогнозирования изменений цен на финансовых рынках.<br>
•  Установление SMART-целей для измерения успеха модели.
2. Стратегия сбора данных:<br>
•  Определение источников данных, таких как финансовые порталы, биржевые платформы и новостные агентства.<br>
•  Сбор исторических цен, объемов торгов, технических индикаторов и новостных данных. 

3. Выбор и обучение модели:<br>
•  Выбор подходящих моделей машинного обучения, способных анализировать временные ряды. Возможно применение LSTM или RNN.

LSTM — это улучшенная версия RNN, которая способна обрабатывать более длинные последовательности данных без потери информации. LSTM решает проблему так называемого "затухания градиента", когда в обычных RNN важная информация теряется с течением времени. LSTM делает это за счет использования специальных структур, называемых "ячейками памяти", которые могут сохранять информацию на протяжении длительного времени.

Эти модели особенно полезны для задач, где необходимо учитывать контекст или последовательность событий, например, при прогнозировании временных рядов, обработке естественного языка или в задачах, связанных с распознаванием речи.<br>
•  Обучение модели на обучающей выборке с последующей валидацией и тестированием.

4. Оценка модели:<br>
•  Использование метрик, таких как точность и F1-мера, для оценки качества прогнозов.<br>

•  Итеративное улучшение модели на основе результатов тестирования.

5. Развертывание модели:<br>
•  Интеграция модели в торговые платформы и финансовые приложения.<br>

•  Предоставление доступа к модели для трейдеров, инвесторов и финансовых аналитиков.

6. Мониторинг и поддержка:<br>
•  Непрерывный мониторинг работы модели и обновление на основе новых данных и обратной связи от пользователей.

### SMART-цели:

1. Специфичность (Specific): Разработать модель машинного обучения, которая может анализировать исторические данные о ценах и объемах торгов, чтобы предсказывать изменения цен на короткие временные интервалы (например, на следующий торговый день).
2. Измеримость (Measurable): Модель должна достигать точности предсказания выше определенного порога, например, 60% точности в прогнозировании направления изменения цены.
3. Достижимость (Achievable): Использовать доступные технологии и алгоритмы машинного обучения, такие как сверточные нейронные сети (CNN) или рекуррентные нейронные сети (RNN), для анализа временных рядов.
4. Релевантность (Relevant): Убедиться, что модель учитывает рыночные условия и может адаптироваться к изменениям в рыночной среде.
5. Ограниченность по времени (Time-bound): Запустить прототип модели в течение следующих 6 месяцев и провести тестирование на исторических данных за последние 10 лет.

### Реализация:
•  Сбор и очистка исторических данных о ценах и объемах торгов.<br>

•  Исследование и выбор подходящих алгоритмов машинного обучения.<br>

•  Разработка и обучение модели на основе выбранных алгоритмов.<br>

•  Тестирование модели на новых данных и оценка ее эффективности.<br>

•  Итеративное улучшение модели на основе обратной связи и результатов тестирования.<br>

Важно помнить! Успех во многом зависит от качества данных и правильности выбора алгоритмов.

### Данные для технического анализа, источники, стратегия сбора.


Для решения задачи биржевого технического анализа с помощью машинного обучения потребуются cледующие данные:<br>
•  Исторические цены: Закрытие, открытие, максимумы и минимумы цен. <br>

•  Объемы торгов: Количество акций или контрактов, торгуемых за определенный период.<br>

•  Индикаторы технического анализа: Скользящие средние, RSI, MACD и другие.<br>

•  Фундаментальные данные: Дивиденды, P/E, и другие финансовые показатели.<br>

•  Новостные данные: Важные новости, которые могут повлиять на цены акций.<br>

Источники данных:

1. Финансовые порталы: Yahoo Finance, Google Finance и другие предоставляют исторические данные о ценах и объемах торгов.
2. Биржевые платформы: Например, NASDAQ, NYSE предоставляют доступ к историческим и текущим торговым данным.
3. API для финансовых данных: Существуют специализированные сервисы, такие как Alpha Vantage, Quandl, которые предоставляют API для доступа к финансовым данным.
4. Новостные агентства: Bloomberg, Reuters и другие источники для сбора новостных данных.
5. Социальные медиа и форумы: Анализ настроений на платформах, таких как Twitter, Reddit, может быть полезен для понимания общественного восприятия.

Стратегия сбора данных:<br>
•  Автоматизация: Использование скриптов для автоматического сбора данных из различных источников.<br>

•  Очистка данных: Предварительная обработка для удаления шума и нерелевантной информации.<br>

•  Хранение данных: Организация данных в структурированные хранилища, такие как базы данных или облачные платформы.<br>

•  Обновление данных: Регулярное обновление данных для обеспечения их актуальности.<br>

•  Учет правовых аспектов: Соблюдение законодательства о данных и авторских прав.<br>

Это краткое резюме стратегии сбора данных, которая может помочь в решении задачи прогнозирования изменений цен на бирже с помощью машинного обучения.<br> Важно помнить, что качество и актуальность данных играют ключевую роль в эффективности модели машинного обучения.

### Модели машинного обучения

Для биржевого технического анализа наиболее подходящими являются модели машинного обучения, способные анализировать временные ряды и улавливать сложные закономерности в данных.<br> Для долговременного инвестирования, торгов во время одной сессии должны рассмариваться разные модели инвестирования.<br> Вот несколько типов моделей, которые могут быть использованы:

1. Рекуррентные нейронные сети (RNN): Особенно полезны для работы с последовательностями данных, такими как временные ряды, потому что они могут учитывать предыдущие данные при прогнозировании будущих значений.
2. Сверточные нейронные сети (CNN): Хотя они чаще используются в обработке изображений, CNN также могут применяться для анализа временных рядов, выделяя важные паттерны в данных.
3. Сети долгой краткосрочной памяти (LSTM): Вариант RNN, который лучше справляется с долгосрочными зависимостями и может быть очень эффективен в прогнозировании временных рядов.
4. Глубокие Q-сети (DQN): Используются в области обучения с подкреплением и могут быть адаптированы для оптимизации торговых стратегий на основе прогнозируемых данных.
5. Ансамблевые методы: Такие как случайный лес или градиентный бустинг, которые могут обрабатывать большое количество признаков и находить сложные нелинейные взаимосвязи в данных.

Почему эти модели подходят:<br>
•  Они способны обрабатывать и анализировать большие объемы данных.<br>

•  Могут улавливать сложные и нелинейные зависимости.<br>

•  Подходят для работы с временными рядами, что критично для финансовых данных.<br>

•  Имеют способность к обучению и адаптации с течением времени.<br>

Дерево решений в контексте биржевого анализа можно применять ограниченно, так как у него есть существенные недосатки:<br>
•  Переобучение: Деревья решений склонны к переобучению, особенно если дерево слишком глубокое.<br>

•  Чувствительность к изменениям в данных: Небольшие изменения в данных могут привести к существенно различным деревьям.<br>

•  Ограниченная выразительность: Для некоторых типов проблем, особенно тех, которые имеют сложные взаимосвязи, деревья решений могут быть не лучшим выбором.<br>

В контексте биржевого анализа, деревья решений могут быть использованы для прогнозирования направления движения цен или для классификации акций на основе фундаментальных и технических показателей.<br> Однако, из-за их недостатков рекомендуется использовать ансамблевые методы, такие как Случайный лес или Градиентный бустинг, которые объединяют множество деревьев решений для улучшения производительности и уменьшения риска переобучения.<br>

Выбор конкретной модели зависит от множества факторов, включая доступные данные, вычислительные ресурсы и специфику задачи. Важно провести тщательное исследование и эксперименты для определения наиболее эффективной модели в каждом конкретном случе с учётом использования разных моделей.

### Подход для обучения и оценки модели
Для обучения и оценки модели машинного обучения, предназначенной для биржевого технического анализа, я бы использовал следующий подход:

1. Подготовка данных:<br>
•  Сбор данных: Создание воображаемого набора данных, который включает исторические цены акций, объемы торгов, и технические индикаторы.<br>

•  Предобработка: Нормализация данных для уменьшения различий в масштабах и очистка от выбросов и пропущенных значений.<br>

2. Разделение данных:<br>
•  Разделение набора данных на обучающую, валидационную и тестовую выборки. Например, 70% данных для обучения, 15% для валидации и 15% для тестирования.<br>

3. Выбор модели:<br>
•  Использование рекуррентной нейронной сети (RNN) или сети долгой краткосрочной памяти (LSTM) для анализа временных рядов.

4. Обучение модели:<br>
•  Конфигурация: Настройка гиперпараметров модели, таких как количество слоев, размеры скрытых слоев и скорость обучения.<br>

•  Обучение: Использование обучающей выборки для тренировки модели с применением методов оптимизации, таких как стохастический градиентный спуск.<br>

5. Валидация и настройка:<br>
•  Проверка модели на валидационной выборке для оценки её производительности и избежания переобучения.<br>

•  Тонкая настройка гиперпараметров на основе результатов валидации.<br>

6. Оценка модели:<br>
•  Тестирование: Использование тестовой выборки для окончательной оценки модели.<br>

•  Метрики: Применение метрик, таких как точность, F1-мера, и коэффициент корреляции для оценки качества прогнозов.<br>

7. Итерация:<br>
•  Повторение процесса с измененными параметрами или структурой модели для улучшения результатов.<br>

8. Документирование:<br>
•  Запись всех шагов, результатов и выводов для последующего анализа и сравнения.<br>

Этот процесс представляет собой итеративный цикл, в котором модель постоянно улучшается и адаптируется к новым данным. <br> Важно поддерживать строгий контроль над качеством данных и процессом обучения для обеспечения достоверности и применимости результатов.

### Развертывание обученной модели машинного обучения для биржевого технического анализа.

Где будет использоваться:
Модель будет интегрирована в торговые платформы, финансовые приложения или представлена как часть API для разработчиков и аналитиков.

Кто будет использовать:<br>
•  Инвестиционные фонды, инвесторы и трейдеры: Для оптимизации своих торговых стратегий.<br>

•  Финансовые аналитики: Для проведения более глубокого анализа рынка.<br>

•  Разработчики финансовых приложений: Для включения функций прогнозирования в свои продукты.<br>

Какую пользу она принесет:<br>
•  Повышение эффективности: Улучшение точности прогнозов, что может привести к более высокой доходности инвестиций.<br>

•  Снижение рисков: Помощь в принятии более обоснованных решений и управлении рисками.<br>

•  Автоматизация: Упрощение процесса принятия решений за счет автоматизации анализа данных.<br>

### Стратегия развертывания:

1. Тестирование в реальных условиях: Перед полным развертыванием провести пилотное тестирование модели в реальных торговых условиях.
2. Интеграция с платформами: Сотрудничество с платформами для интеграции модели в существующие системы.
3. Обучение пользователей: Предоставление ресурсов и обучающих материалов для пользователей, чтобы они могли эффективно использовать модель.
4. Мониторинг и поддержка: Непрерывный мониторинг работы модели и предоставление технической поддержки пользователям.
5. Обновление и улучшение: Регулярное обновление модели на основе новых данных и обратной связи от пользователей.

Стратегия развертывания направлена на постоянное улучшение модели.  Она будет понятна и полезна для конечных пользователей, а также будет постоянно улучшаться и адаптироваться к меняющимся рыночным условиям.

### Вывод.
Процесс требует тщательного планирования, регулярного обновления данных и постоянного улучшения моделей для адаптации. <br> Скорее всего будут использоваться разные модели, так как с учётом разых временных промежутков модели будут разными.<br> В зависимоти от возможностей инвесора и сроков инвестирования будут применимы разные модели. 
Ключевым фактором успеха является качество данных и правильный выбор алгоритмов машинного обучения.<br> В конечном итоге, цель состоит в том, чтобы предоставить пользователям надежный инструмент для принятия обоснованных торговых решений и управления рисками в завсимости от выбранной стратегии инвестирования.